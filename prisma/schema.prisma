generator client {
    provider = "prisma-client"
    output   = "./generated/prisma"
}

datasource db {
    provider = "sqlite"
}

model Document {
    id              String   @id
    title           String
    confidentiality Int      @default(0)
    integrity       Int      @default(0)
    availability    Int      @default(0)
    createdAt       DateTime @default(now()) @map("created_at")

    snapshot DocumentSnapshot?
    updates  DocumentUpdate[]

    @@map("documents")
}

model DocumentSnapshot {
    documentId String   @id @map("document_id")
    document   Document @relation(fields: [documentId], references: [id], onDelete: Cascade)
    snapshot   Bytes    @map("snapshot_update")
    updatedAt  BigInt   @map("updated_at")

    @@map("document_snapshots")
}

model DocumentUpdate {
    id         Int      @id @default(autoincrement())
    documentId String   @map("document_id")
    document   Document @relation(fields: [documentId], references: [id], onDelete: Cascade)
    update     Bytes
    createdAt  BigInt   @map("created_at")

    @@index([documentId, id])
    @@map("document_updates")
}
